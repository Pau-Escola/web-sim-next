(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[495],{8090:function(e,t,s){(window.__NEXT_P=window.__NEXT_P||[]).push(["/products-management",function(){return s(5874)}])},4093:function(e,t){"use strict";t.Z={src:"/_next/static/media/logo.24cbf371.png",height:382,width:653,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAFCAMAAABPT11nAAAAJFBMVEVNYUSqqQpLZkydnhynpghUcEMtTGwKQGqrqAYEQGsFPmytqgWjkzTQAAAADHRSTlMCTB80fCcUOq2Nh9qsm1mAAAAACXBIWXMAAAsTAAALEwEAmpwYAAAALElEQVR4nB3KsREAMAjDQGMDAbL/vjmi6gshug82l7wMQJn5XQQZYiY4858HDL8AjCjgcFsAAAAASUVORK5CYII=",blurWidth:8,blurHeight:5}},5874:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return C}});var r=s(5893),a=s(7294),o=s(7066),n=e=>{let{isOpen:t,onClose:s,onLogin:n}=e,[c,l]=(0,a.useState)(""),[i,d]=(0,a.useState)(""),u=async e=>{e.preventDefault();try{let{token:e}=(await o.Z.post("".concat("https://simreus.com/api","/auth/login"),{username:c,password:i})).data;localStorage.setItem("token",e),n(e),s()}catch(e){alert("Login failed:",e)}};return(0,r.jsx)("div",{className:"modal ".concat(t?"block":"hidden"),style:{zIndex:1e3},children:(0,r.jsx)("div",{className:"modal-container bg-white w-96 mx-auto rounded shadow-lg  mt-24 p-4",children:(0,r.jsxs)("form",{onSubmit:u,children:[(0,r.jsxs)("div",{className:"mb-4",children:[(0,r.jsx)("label",{htmlFor:"username",className:"block text-sm font-medium text-gray-700",children:"Username"}),(0,r.jsx)("input",{type:"text",id:"username",value:c,onChange:e=>l(e.target.value),required:!0,className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm"})]}),(0,r.jsxs)("div",{className:"mb-4",children:[(0,r.jsx)("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700",children:"Contrassenya"}),(0,r.jsx)("input",{type:"password",id:"password",value:i,onChange:e=>d(e.target.value),required:!0,className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm"})]}),(0,r.jsx)("div",{className:"flex justify-end",children:(0,r.jsx)("button",{type:"submit",className:"inline-flex justify-center py-2 px-4 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",children:"Login"})})]})})})},c=s(5675),l=s.n(c),i=s(9540),d=e=>{let{product:t,onSelectProduct:s,token:n,fetchProducts:c}=e,d=t.images.find(e=>!0===e.isMain),[u,m]=(0,a.useState)(!1),h="https://simreus.com/api",x=async e=>{e.stopPropagation();try{await o.Z.delete("".concat(h,"/products/").concat(t.reference),{headers:{Authorization:"Bearer ".concat(n)}}),c()}catch(e){console.error("Error deleting product:",e)}},g=async e=>{e.stopPropagation();try{let e=!t.booked;await o.Z.patch("".concat(h,"/products/").concat(t.reference),{booked:e},{headers:{Authorization:"Bearer ".concat(n)}}),c()}catch(e){console.error("Error toggling booked status:",e)}},p=async e=>{e.stopPropagation();try{let e=!t.sold;await o.Z.patch("".concat(h,"/products/").concat(t.reference),{sold:e},{headers:{Authorization:"Bearer ".concat(n)}}),c()}catch(e){console.error("Error toggling sold status:",e)}};return(0,r.jsxs)("div",{className:"relative shadow-xl rounded-lg overflow-hidden w-[20vh] h-[20vh] md:w-[25vh] md:h-[25vh] lg:w-[30vh] lg:h-[30vh] group",children:[d&&(0,r.jsx)(l(),{src:"".concat("http://simreus.com/productService").concat(d.imageUrl),alt:t.title,layout:"fill",objectFit:"cover",className:"absolute inset-0 z-0"}),(0,r.jsx)("div",{className:"absolute inset-0 flex flex-col justify-end",children:(0,r.jsx)("div",{className:"bg-black bg-opacity-60 text-white p-2",children:(0,r.jsx)("div",{className:"flex justify-between items-center w-full",children:(0,r.jsx)("h3",{className:"text-white text-l md:text-xl font-semibold",children:t.title})})})}),(0,r.jsxs)("div",{className:"absolute top-2 right-2 flex space-x-2",children:[(0,r.jsx)("button",{onClick:()=>m(!0),className:"text-red-600 bg-white rounded-full p-2",children:(0,r.jsx)(i.Xm5,{})}),(0,r.jsx)("button",{onClick:g,className:"text-yellow-600 bg-white rounded-full p-2 ".concat(t.booked?"":"opacity-50"),children:(0,r.jsx)(i.VF9,{})}),(0,r.jsx)("button",{onClick:p,className:"text-green-600 bg-white rounded-full p-2 ".concat(t.sold?"":"opacity-50"),children:(0,r.jsx)(i.l_A,{})}),(0,r.jsx)("button",{onClick:()=>s(t),className:"text-blue-600 bg-white rounded-full p-2",children:(0,r.jsx)(i.fmQ,{})})]}),u&&(0,r.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",children:(0,r.jsxs)("div",{className:"relative w-full max-w-lg p-8 bg-white rounded-lg shadow-lg",children:[(0,r.jsx)("h3",{className:"text-xl font-bold mb-4",children:"Segur que vols esborrar el producte?"}),(0,r.jsxs)("div",{className:"flex space-x-4",children:[(0,r.jsx)("button",{onClick:x,className:"px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 transition",children:"Si"}),(0,r.jsx)("button",{onClick:()=>m(!1),className:"px-4 py-2 bg-gray-300 rounded-md hover:bg-gray-400 transition",children:"No"})]})]})})]})},u=s(5810),m=s(6373),h=s.n(m),x=e=>{let{images:t,token:s,fetchProduct:n,productId:c}=e,i=(0,a.useRef)(null),d="https://simreus.com/api",u=new(h()),m=async(e,t)=>{let s=new window.Image,r=document.createElement("canvas"),a=r.getContext("2d");return new Promise((o,n)=>{s.onload=()=>{let e=t/s.width;r.width=t,r.height=s.height*e,a.drawImage(s,0,0,r.width,r.height),u.resize(r,r).then(()=>u.toBlob(r,"image/jpeg",.8)).then(e=>o(e)).catch(e=>n(e))},s.onerror=n,s.src=URL.createObjectURL(e)})},x=async e=>{if(1===t.length){alert("Product must have at least one image");return}try{await o.Z.delete("".concat(d,"/product-images/").concat(e),{headers:{Authorization:"Bearer ".concat(s)}}),n()}catch(e){console.error("Error deleting image:",e)}},g=async e=>{try{await o.Z.put("".concat(d,"/product-images/set-to-main-image/").concat(e),{},{headers:{Authorization:"Bearer ".concat(s)}}),n()}catch(e){console.error("Error setting main image:",e)}},p=async e=>{let t=e.target.files[0];if(!t){alert("No file found");return}try{let e=await m(t,1200),r=new File([e],"1200_".concat(t.name),{type:"image/jpeg"}),a=new FormData;a.append("image",r),console.log("Uploading resized image...");let l=(await o.Z.post("https://www.simreus.com/productService/upload",a,{headers:{"Content-Type":"multipart/form-data"}})).data.imageUrls[0];console.log("Image uploaded, URL:",l),await o.Z.post("".concat(d,"/product-images"),{productId:c,isMain:!1,imageUrl:l},{headers:{Authorization:"Bearer ".concat(s)}}),n()}catch(e){alert("Error uploading image"),console.error("Error uploading image:",e)}};return(0,r.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4 w-full h-full",children:[t.map((e,t)=>(0,r.jsxs)("div",{className:"w-full h-full flex-shrink-0 relative",children:[(0,r.jsx)(l(),{src:"".concat("http://simreus.com/productService").concat(e.imageUrl),alt:e.alt||"Image",layout:"responsive",width:500,height:500,className:"w-full h-auto object-cover",loading:"lazy"}),(0,r.jsx)("button",{onClick:()=>x(e.id),className:"absolute top-2 right-2 bg-red-600 font-bold text-white p-2 rounded",children:"\xd7"}),(0,r.jsxs)("label",{className:"absolute bottom-2 left-2 bg-white p-1 rounded cursor-pointer",children:[(0,r.jsx)("input",{type:"checkbox",checked:e.isMain,disabled:e.isMain,onChange:()=>g(e.id),className:"mr-2"}),"Principal"]})]},t)),(0,r.jsxs)("div",{onClick:()=>{i.current.click()},className:"w-full h-full flex-shrink-0 flex items-center justify-center border-2 border-dashed border-gray-300 cursor-pointer",children:[(0,r.jsx)("span",{className:"text-4xl",children:"+"}),(0,r.jsx)("input",{type:"file",ref:i,style:{display:"none"},onChange:p})]})]})},g=e=>{let{product:t,onClose:s,token:n,fetchProducts:c}=e,l=!t.reference,[i,d]=(0,a.useState)({...t}),[m,h]=(0,a.useState)(l),[g,p]=(0,a.useState)(!1),b="https://simreus.com/api",f=async()=>{let{title:e,description:r,sold:a,booked:d,itemType:u,length:m,width:x}=i,g={title:e,description:r,sold:a,booked:d,itemType:u,length:m,width:x};if(g.title&&g.description)try{l?await o.Z.post("".concat(b,"/products"),g,{headers:{Authorization:"Bearer ".concat(n)}}):await o.Z.patch("".concat(b,"/products/").concat(t.reference),g,{headers:{Authorization:"Bearer ".concat(n)}}),h(!1),c(),l&&s()}catch(e){console.error("Error saving product:",e)}else alert("Els camps t\xedtol i descripci\xf3 sempre han de tindre un valor")},j=e=>{d({...i,[e.target.name]:e.target.value})},w=async()=>{try{await o.Z.delete("".concat(b,"/products/").concat(t.reference),{headers:{Authorization:"Bearer ".concat(n)}}),s(),c()}catch(e){console.error("Error deleting product:",e)}},y=async()=>{try{let e=!i.booked;await o.Z.patch("".concat(b,"/products/").concat(t.reference),{booked:e},{headers:{Authorization:"Bearer ".concat(n)}}),d({...i,booked:e}),c()}catch(e){console.error("Error toggling booked status:",e)}},v=async()=>{try{let e=!i.sold;await o.Z.patch("".concat(b,"/products/").concat(t.reference),{sold:e},{headers:{Authorization:"Bearer ".concat(n)}}),d({...i,sold:e,booked:!e&&i.booked}),c()}catch(e){console.error("Error toggling sold status:",e)}},N=async()=>{try{let e=await o.Z.get("".concat(b,"/products/").concat(t.reference),{headers:{Authorization:"Bearer ".concat(n)}});d(e.data)}catch(e){console.error("Error fetching product:",e)}};return t||l?(0,r.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",children:(0,r.jsxs)("div",{className:"relative w-full max-w-4xl p-8 bg-white rounded-lg shadow-lg",children:[(0,r.jsx)("button",{onClick:s,className:"absolute top-2 right-2 text-gray-600 hover:text-gray-900 text-3xl font-bold",children:"\xd7"}),(0,r.jsx)("div",{className:"mb-4",children:m?(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{children:"T\xedtol"}),(0,r.jsx)("input",{type:"text",name:"title",placeholder:"Nom",value:i.title||"",onChange:j,className:"border p-2 w-full mb-2"})]}):(0,r.jsxs)("h2",{className:"text-2xl font-bold mb-4 cursor-pointer",onClick:()=>{h(!0)},children:["T\xedtol: ",i.title," ",(0,r.jsx)("span",{className:"text-sm text-white font-bold rounded-md bg-primary p-2",children:"Editar info"})]})}),(0,r.jsx)("div",{className:"mb-4",children:m?(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{children:"Descripci\xf3"}),(0,r.jsx)("textarea",{name:"description",placeholder:"Descripci\xf3",value:i.description||"",onChange:j,className:"border p-2 w-full mb-2"})]}):(0,r.jsxs)("p",{className:"text-lg mb-4 ",children:["Descripci\xf3: ",i.description]})}),(0,r.jsx)("div",{className:"mb-4",children:m?(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{children:"Llarg (NO posar la \xb4m\xb4 al final)"}),(0,r.jsx)("input",{type:"text",name:"length",placeholder:"utilitzar el \xb4.\xb4 pel decimal",value:i.length||"",onChange:j,className:"border p-2 w-full mb-2"}),(0,r.jsx)("p",{children:"Ample (no posar la \xb4m\xb4 al final)"}),(0,r.jsx)("input",{type:"text",name:"width",placeholder:"utilitzar el \xb4.\xb4 pel decimal",value:i.width||"",onChange:j,className:"border p-2 w-full mb-2"})]}):(0,r.jsxs)("p",{className:"text-lg mb-4",children:["Llarg: ",i.length," m ",(0,r.jsx)("br",{}),"Ample: ",i.width," m"]})}),(0,r.jsx)("div",{className:"mb-4",children:m?(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{children:"Tipus"}),(0,r.jsxs)("select",{id:"itemType",name:"itemType",value:i.itemType,onChange:j,className:"border p-2 w-full mb-2",required:!0,children:[(0,r.jsx)("option",{value:"",children:"-- Tipus de producte --"}),(0,r.jsx)("option",{value:"PREFAB",children:"MODUL"}),(0,r.jsx)("option",{value:"CONTAINER",children:"CONTENIDOR"})]})]}):(0,r.jsxs)("p",{className:"text-lg font-bold mb-4",children:["Tipus de producte: ","PREFAB"===i.itemType?"M\xd2DUL":"CONTENIDOR"]})}),m&&(0,r.jsx)("div",{className:"mb-4",children:(0,r.jsx)("button",{onClick:f,className:"px-4 py-2 bg-primary text-white rounded-md hover:bg-secondary transition",children:"Guardar"})}),!l&&(0,r.jsx)(x,{images:i.images,productId:i.reference,token:n,fetchProduct:N}),!l&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{className:"flex space-x-4 items-center mt-4",children:[(0,r.jsx)("span",{children:"Reservat:"}),(0,r.jsx)(u.Z,{onChange:y,checked:i.booked,uncheckedIcon:!1,checkedIcon:!1,offColor:"#bbb",onColor:"#f5a623",disabled:i.sold})]}),(0,r.jsxs)("div",{className:"flex space-x-4 items-center mt-4",children:[(0,r.jsx)("span",{children:"Venut:"}),(0,r.jsx)(u.Z,{onChange:v,checked:i.sold,uncheckedIcon:!1,checkedIcon:!1,offColor:"#bbb",onColor:"#4caf50"})]}),(0,r.jsx)("div",{className:"mt-4",children:(0,r.jsx)("button",{onClick:()=>p(!0),className:"px-4 py-2 bg-red-600 text-white font-bold rounded-md hover:bg-red-700 transition",children:"Esborrar producte"})})]}),g&&(0,r.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",children:(0,r.jsxs)("div",{className:"relative w-full max-w-lg p-8 bg-white rounded-lg shadow-lg",children:[(0,r.jsx)("h3",{className:"text-xl font-bold mb-4",children:"Segur que vols esborrar el producte?"}),(0,r.jsxs)("div",{className:"flex space-x-4",children:[(0,r.jsx)("button",{onClick:w,className:"px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 transition",children:"Si"}),(0,r.jsx)("button",{onClick:()=>p(!1),className:"px-4 py-2 bg-gray-300 rounded-md hover:bg-gray-400 transition",children:"No"})]})]})})]})}):null},p=e=>{let{token:t}=e,[s,n]=(0,a.useState)([]),[c,l]=(0,a.useState)(null),[i,u]=(0,a.useState)(""),[m,h]=(0,a.useState)(null),x="https://simreus.com/api";(0,a.useEffect)(()=>{b()},[t]);let p=e=>{l(e)},b=async()=>{try{let e=await o.Z.get("".concat(x,"/products"),{headers:{Authorization:"Bearer ".concat(t)}});n(e.data),h(null)}catch(e){alert("No ha pogut carregar els productes",e),e.response&&401===e.response.status&&setToken(null)}},f=async()=>{if(i)try{let e=await o.Z.get("".concat(x,"/products/").concat(i),{headers:{Authorization:"Bearer ".concat(t)}});h(e.data)}catch(e){alert("Producte no trobat",e),h(null)}};return(0,r.jsxs)("div",{children:[(0,r.jsx)("h2",{className:"text-3xl font-semibold p-3",children:"Productes"}),(0,r.jsxs)("div",{className:"flex mb-4",children:[(0,r.jsx)("input",{type:"text",value:i,onChange:e=>{u(e.target.value)},placeholder:"Referencia al correu",className:"p-2 border border-gray-300 rounded-md mr-2"}),(0,r.jsx)("button",{onClick:f,className:"px-4 py-2 bg-primary text-white text-xl font-semibold rounded-md hover:bg-secondary transition",children:"Buscar per referencia"}),(0,r.jsx)("button",{onClick:()=>{u(""),b()},className:"ml-2 px-4 py-2 bg-gray-300 text-black text-xl font-semibold rounded-md hover:bg-gray-400 transition",children:"Mostrar tots"})]}),(0,r.jsx)("button",{onClick:()=>{l({})},className:"mb-4 px-4 py-2 bg-primary text-white text-xl font-semibold rounded-md hover:bg-secondary transition",children:"Crear nou producte"}),(0,r.jsx)("section",{className:"grid grid-cols-2 md:grid-cols-2 lg:grid-cols-4 gap-8",children:m?(0,r.jsx)(d,{product:m,onSelectProduct:p,token:t,fetchProducts:b},m.reference):s.map(e=>(0,r.jsx)(d,{product:e,onSelectProduct:p,token:t,fetchProducts:b},e.reference))}),null!==c&&(0,r.jsx)(g,{product:c,onClose:()=>{b(),l(null)},token:t,fetchProducts:b})]})},b=e=>{let{isOpen:t,onClose:s,token:n,fetchWorkers:c}=e,[l,i]=(0,a.useState)(""),[d,u]=(0,a.useState)(""),[m,h]=(0,a.useState)(!1),x=async e=>{e.preventDefault();try{await o.Z.post("".concat("https://simreus.com/api","/workers"),{username:l,password:d,isAdmin:m},{headers:{Authorization:"Bearer ".concat(n)}}),c(n),s()}catch(e){console.error("Failed to create worker:",e)}};return t?(0,r.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",children:(0,r.jsxs)("div",{className:"relative w-full max-w-md p-8 bg-white rounded-lg shadow-lg",children:[(0,r.jsx)("button",{onClick:s,className:"absolute top-2 right-2 text-gray-600 hover:text-gray-900 text-3xl font-bold",children:"\xd7"}),(0,r.jsx)("h2",{className:"text-2xl font-bold mb-4",children:"Crear usuari"}),(0,r.jsxs)("form",{onSubmit:x,children:[(0,r.jsx)("div",{className:"mb-4 p-2",children:(0,r.jsx)("input",{type:"text",value:l,placeholder:"Nom de usuari",onChange:e=>i(e.target.value),className:" p-2mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm",required:!0})}),(0,r.jsx)("div",{className:"mb-4 p-2",children:(0,r.jsx)("input",{type:"password",value:d,placeholder:"Contrassenya",onChange:e=>u(e.target.value),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm",required:!0})}),(0,r.jsxs)("div",{className:"mb-4",children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Admin"}),(0,r.jsx)("input",{type:"checkbox",checked:m,onChange:e=>h(e.target.checked),className:"mt-1 block"})]}),(0,r.jsx)("button",{type:"submit",className:"py-2 px-4 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",children:"Crear"})]})]})}):null},f=e=>{let{isOpen:t,onClose:s,token:n,worker:c,fetchWorkers:l}=e,[i,d]=(0,a.useState)(c.isAdmin),u=async e=>{e.preventDefault();try{await o.Z.patch("".concat("https://simreus.com/api","/workers/").concat(c.id),{isAdmin:i},{headers:{Authorization:"Bearer ".concat(n)}}),l(n),s()}catch(e){console.error("Failed to update worker:",e)}};return t?(0,r.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",children:(0,r.jsxs)("div",{className:"relative w-full max-w-md p-8 bg-white rounded-lg shadow-lg",children:[(0,r.jsx)("button",{onClick:s,className:"absolute top-2 right-2 text-gray-600 hover:text-gray-900 text-3xl font-bold",children:"\xd7"}),(0,r.jsx)("h2",{className:"text-2xl font-bold mb-4",children:"Canviar permissos"}),(0,r.jsxs)("form",{onSubmit:u,children:[(0,r.jsxs)("div",{className:"mb-4",children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Admin"}),(0,r.jsx)("input",{type:"checkbox",checked:i,onChange:e=>d(e.target.checked),className:"mt-1 block"})]}),(0,r.jsx)("button",{type:"submit",className:"py-2 px-4 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",children:"Actualitzar"})]})]})}):null},j=e=>{let{isOpen:t,onClose:s,token:n,worker:c,fetchWorkers:l}=e,[i,d]=(0,a.useState)(""),u=async e=>{e.preventDefault();try{await o.Z.patch("".concat("https://simreus.com/api","/workers/").concat(c.id),{password:i},{headers:{Authorization:"Bearer ".concat(n)}}),l(n),s()}catch(e){console.error("Failed to change password:",e)}};return t?(0,r.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",children:(0,r.jsxs)("div",{className:"relative w-full max-w-md p-8 bg-white rounded-lg shadow-lg",children:[(0,r.jsx)("button",{onClick:s,className:"absolute top-2 right-2 text-gray-600 hover:text-gray-900 text-3xl font-bold",children:"\xd7"}),(0,r.jsx)("h2",{className:"text-2xl font-bold mb-4",children:"Canvia contrassenya"}),(0,r.jsxs)("form",{onSubmit:u,children:[(0,r.jsxs)("div",{className:"mb-4",children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Nova contrassenya"}),(0,r.jsx)("input",{type:"password",value:i,onChange:e=>d(e.target.value),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm",required:!0})]}),(0,r.jsx)("button",{type:"submit",className:"py-2 px-4 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",children:"Aplicar canvi"})]})]})}):null},w=e=>{let{workers:t,token:s,fetchWorkers:n}=e,[c,l]=(0,a.useState)(!1),[i,d]=(0,a.useState)(null),[u,m]=(0,a.useState)(!1),[h,x]=(0,a.useState)(!1),[g,p]=(0,a.useState)(!1),w=async e=>{try{await o.Z.delete("".concat("https://simreus.com/api","/workers/").concat(e),{headers:{Authorization:"Bearer ".concat(s)}}),n(s),p(!1)}catch(e){console.error("Failed to delete worker:",e)}};return(0,r.jsxs)("div",{className:"text-lg leading-relaxed",children:[(0,r.jsx)("h2",{className:"text-2xl font-semibold mb-4",children:"Usuaris"}),(0,r.jsx)("button",{onClick:()=>l(!0),className:"py-2 px-4 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 mb-4",children:"Crear usuari"}),(0,r.jsx)("ul",{className:"divide-y divide-gray-300",children:t.map(e=>(0,r.jsxs)("li",{className:"flex justify-between items-center py-4",children:[(0,r.jsx)("span",{children:e.username}),(0,r.jsxs)("div",{className:"space-x-2",children:[(0,r.jsx)("button",{onClick:()=>{d(e),m(!0)},className:"py-1 px-2 text-sm font-medium rounded-md text-white bg-yellow-500 hover:bg-yellow-600",children:"Canviar permisos"}),(0,r.jsx)("button",{onClick:()=>{d(e),x(!0)},className:"py-1 px-2 text-sm font-medium rounded-md text-white bg-blue-500 hover:bg-blue-600",children:"Canviar contrassenya"}),(0,r.jsx)("button",{onClick:()=>{d(e),p(!0)},className:"py-1 px-2 text-sm font-medium rounded-md text-white bg-red-500 hover:bg-red-600",children:"Esborrar"})]})]},e.id))}),c&&(0,r.jsx)(b,{isOpen:c,onClose:()=>l(!1),token:s,fetchWorkers:n}),u&&i&&(0,r.jsx)(f,{isOpen:u,onClose:()=>m(!1),token:s,worker:i,fetchWorkers:n}),h&&i&&(0,r.jsx)(j,{isOpen:h,onClose:()=>x(!1),token:s,worker:i,fetchWorkers:n}),g&&(0,r.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",children:(0,r.jsxs)("div",{className:"relative w-full max-w-lg p-8 bg-white rounded-lg shadow-lg",children:[(0,r.jsx)("h3",{className:"text-xl font-bold mb-4",children:"Segur que vols esborrar el treballador?"}),(0,r.jsxs)("div",{className:"flex space-x-4",children:[(0,r.jsx)("button",{onClick:()=>w(i.id),className:"px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 transition",children:"Si"}),(0,r.jsx)("button",{onClick:()=>p(!1),className:"px-4 py-2 bg-gray-300 rounded-md hover:bg-gray-400 transition",children:"No"})]})]})})]})},y=e=>{let{workers:t,fetchWorkers:s,token:o}=e,[n,c]=(0,a.useState)("");return(0,r.jsxs)("div",{className:"p-10",children:[(0,r.jsx)("h1",{className:"text-4xl font-bold text-center p-8",children:"Panell Administrador"}),(0,r.jsx)("div",{className:"flex flex-col items-center mt-8",children:(0,r.jsxs)("div",{className:"flex space-x-4 ",children:[(0,r.jsx)("button",{onClick:()=>c("products"),className:"py-2 px-4 border border-transparent shadow-sm text-xl font-bold rounded-md text-white bg-primary hover:bg-secondary focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",children:"Administrar Productes"}),(0,r.jsx)("button",{onClick:()=>c("workers"),className:"py-2 px-4 border border-transparent shadow-sm text-xl font-bold rounded-md text-white bg-primary hover:bg-secondary focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",children:"Administrar Usuaris"})]})}),"products"===n&&(0,r.jsx)(p,{token:o}),"workers"===n&&(0,r.jsx)(w,{workers:t,token:o,fetchWorkers:s})]})},v=e=>{let{products:t,token:s}=e;return(0,r.jsxs)("div",{className:"p-10",children:[(0,r.jsx)("h1",{className:"text-4xl font-bold text-center p-8",children:"Gesti\xf3 de productes"}),(0,r.jsx)(p,{products:t,token:s})]})},N=s(1664),k=s.n(N);s(1163);var A=s(4093),C=()=>{let[e,t]=(0,a.useState)(null),[s,c]=(0,a.useState)(!1),[i,d]=(0,a.useState)([]),[u,m]=(0,a.useState)([]),[h,x]=(0,a.useState)(!1);(0,a.useEffect)(()=>{let e=localStorage.getItem("token");e?(t(e),p(e)):c(!0)},[]);let g=()=>{localStorage.removeItem("token"),t(null),x(!1),c(!0)},p=async e=>{if(!e){c(!0);return}try{let t=await o.Z.get("".concat("https://simreus.com/api","/workers"),{headers:{Authorization:"Bearer ".concat(e)}});m(t.data),x(!0)}catch(e){console.error("Failed to fetch workers or user is not an admin:",e),x(!1),e.response&&401===e.response.status&&g()}};return(0,r.jsxs)("div",{className:"bg-gray-300",children:[(0,r.jsxs)("nav",{className:"p-3 flex justify-between items-center  top-0 left-0 w-full z-50 bg-white shadow-md",children:[(0,r.jsx)("div",{className:"w-40 cursor-pointer",children:(0,r.jsx)(k(),{href:"/",children:(0,r.jsx)(l(),{src:A.Z,alt:"Company Logo",width:160,height:40,priority:!0})})}),e&&(0,r.jsx)("div",{className:"flex items-center",children:(0,r.jsx)("button",{onClick:g,className:"px-4 py-2 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-red-600 hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500",children:"Logout"})})]}),e?(0,r.jsx)("div",{children:h?(0,r.jsx)(y,{workers:u,fetchWorkers:p,token:e}):(0,r.jsx)(v,{token:e})}):(0,r.jsx)("div",{children:(0,r.jsx)(n,{isOpen:s,onClose:()=>c(!1),onLogin:e=>{localStorage.setItem("token",e),t(e),c(!1),p(e)}})})]})}}},function(e){e.O(0,[365,61,115,183,888,774,179],function(){return e(e.s=8090)}),_N_E=e.O()}]);